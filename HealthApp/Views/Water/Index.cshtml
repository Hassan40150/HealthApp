@model HealthApp.ViewModels.WaterViewModel


<!-- Range Selector -->
<label for="rangeSlider">Select Time Range:</label>
<input type="range"
       id="rangeSlider"
       name="rangeSlider"
       min="0"
       max="5"
       step="1"
       value="@((int)Model.SelectedRange)" />
<div id="rangeLabel" class="fw-bold"></div>

<br />
<br />

<!-- Raw Data Output -->
<h2>Today's Water Intake: <span id="TodaysWaterIntake">@Model.TodaysWaterIntake mL</span></h2>
<h2>Today's Progress: <span id="TodaysProgress">@Model.TodaysProgressPercentage%</span></h2>

<h2>Average Water Intake (Selected Range): <span id="AverageWaterIntake">@Model.AverageWaterIntake mL/day</span></h2>
<h2>Highest Daily Intake: <span id="HighestIntake">@Model.HighestIntake mL</span></h2>
<h2>Lowest Daily Intake: <span id="LowestIntake">@Model.LowestIntake mL</span></h2>

<h2>Recommended Hydration Goal: <span id="RecommendedGoal">@Model.RecommendedHydrationGoal mL</span></h2>
<h2>Typical Water Loss Per Day: <span id="TypicalWaterLoss">@Model.TypicalWaterLossPerDay mL</span></h2>

<script>
    const rangeOptions = [
        '1 Week',
        '2 Weeks',
        '3 Months',
        '6 Months',
        '12 Months',
        '24 Months'
    ];

    function updateRangeLabel(val) {
        document.getElementById('rangeLabel').innerText = rangeOptions[val];
    }

    async function reloadData(val) {
        try {
            const response = await fetch(`/water/getdata?range=${val}`);
            const data = await response.json();

            document.getElementById('TodaysWaterIntake').innerText = data.todaysWaterIntake + ' mL';
            document.getElementById('TodaysProgress').innerText = data.todaysProgressPercentage + '%';

            document.getElementById('AverageWaterIntake').innerText = data.averageWaterIntake + ' mL/day';
            document.getElementById('HighestIntake').innerText = data.highestIntake + ' mL';
            document.getElementById('LowestIntake').innerText = data.lowestIntake + ' mL';

            document.getElementById('RecommendedGoal').innerText = data.recommendedHydrationGoal + ' mL';
            document.getElementById('TypicalWaterLoss').innerText = data.typicalWaterLossPerDay + ' mL';

        } catch (error) {
            console.error('Error fetching water data:', error);
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        updateRangeLabel(document.getElementById('rangeSlider').value);

        document.getElementById('rangeSlider').addEventListener('input', function () {
            updateRangeLabel(this.value);
        });

        document.getElementById('rangeSlider').addEventListener('change', function () {
            reloadData(this.value);
        });
    });
</script>
